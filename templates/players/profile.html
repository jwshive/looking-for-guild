{% extends '_layout.html' %}
{% load humanize %}

{% block title %}
My Profile - {{ user.username }}
{% endblock %}

{% block content %}

    <!--- My Profile --->
    <h2>My Profile</h2>
    <h4><a href="{% url 'update-profile' my_profile.profile.id  %}">Update My Profile</a></h4>

    <table class="table">
        <tr>
            <th>Battle Tag</th>
            <td>{% if my_profile.profile.battle_net_id %}{{ my_profile.profile.battle_net_id }}{% else %} Update your profile to set a BattleNet ID.{% endif %}</td>
        </tr>
        <tr>
            <th>Timezone</th>
            <td>{% if my_profile.profile.user_timezone %}{{ my_profile.profile.user_timezone }}{% else %}Update your profile to set your Timezone.{% endif %}</td>
        </tr>
        <tr>
            <th>Biography</th>
            <td>{% if my_profile.profile.biography %}{{ my_profile.profile.biography }}{% else %}Update your profile to fill out your game history.{% endif %}</td>
        </tr>
    </table>


    <!--- Show Guilds I Own --->
    <h2>My Guilds</h2>

    <h4><a href="{% url 'add-guild' user.id %}">Add a new Guild</a></h4>
    {% if my_guilds %}
        <table class="table">
            <tr>
                <th></th>
                <th>Name</th>
                <th>Realm</th>
                <th>Faction</th>
                <th>Add Recruitment Posts</th>
            </tr>
            {% for guild in my_guilds %}
                <tr>
                    <td></td>
                    <td><a href="{% url 'guild-detail' guild.id %}">{{ guild.guild_name }}</a></td>
                    <td>{{ guild.guild_realm }}</td>
                    <td>{{ guild.guild_faction }}</td>
                    <td><a href="{% url 'add-recruitment-post' guild_pk=guild.id %}">Here</a></td>
                </tr>
            {% endfor %}
        </table>
    {% else %}
        You are not the owner of any guilds.
    {% endif %}

    <h2>My Recruitment Posts</h2>

    {% if my_recruitment_posts %}
        <table class="table">
            <tr>
                <th>Guild Name</th>
                <th>Post Title</th>
                <th>Created</th>
                <th>Active</th>
            </tr>
            {% for item in my_recruitment_posts %}
                <tr>
                    <td><a href="{% url 'update-recruitment-post' item.pk %}">{{ item.guild_name }}</a></td>
                    <td>{{ item.recruitment_title }}</td>
                    <td>{{ item.create_date|naturaltime }}</td>
                    <td>{{ item.is_post_active }}</td>
                </tr>
            {% endfor %}
        </table>
    {% else %}
        You currently have no recruitment posts for any guilds you own.
    {% endif %}

    <!--- Show Characters I've Created --->
    <h2>My Characters</h2>

    <h4><a href="{% url 'add-character' user.id %}">Add a new Character</a></h4>

    <table class="table">
        <tr>
            <th></th>
            <th>Name</th>
            <th>Realm</th>
            <th>Faction</th>
            <th>Class</th>
        </tr>
        {% for character in my_characters %}
            <tr>
                <td><img src="{{ website_settings.wow_api_character_image_base_url }}/{{ character.character_profile_inset_url }}"></td>
                <td><a href="{% url 'character-details' character.character_link.id %}">{{ character.character_link.character_name }}</a></td>
                <td>{{ character.character_link.character_realm }}</td>
                <td>{{ character.character_faction}}</td>
                <td>{{ character.character_class }}</td>
            </tr>
        {% endfor %}
    </table>

{% endblock %}

